<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>CLOYZZI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:#000;
  font-family:Arial,Helvetica,sans-serif;
}
#overlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#000;
  z-index:10;
  cursor:pointer;
}
#overlay span{
  color:#fff;
  font-size:24px;
  letter-spacing:4px;
  animation:flicker 2s infinite;
}
@keyframes flicker{
  0%,100%{opacity:1}
  50%{opacity:.3}
}
canvas{
  display:block;
}
</style>
</head>
<body>

<div id="overlay"><span>CLICK TO ENTER THE VOID</span></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/loaders/FontLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/geometries/TextGeometry.js"></script>

<script>
let scene,camera,renderer,clock;
let analyser,dataArray;
let textMesh,particles;
let started=false;

const overlay=document.getElementById("overlay");

overlay.onclick=async()=>{
  overlay.remove();
  await startAudio();
  init();
  animate();
};

async function startAudio(){
  const audio=new Audio("music.mp3");
  audio.loop=true;
  audio.volume=0.6;
  const ctx=new (window.AudioContext||window.webkitAudioContext)();
  const src=ctx.createMediaElementSource(audio);
  analyser=ctx.createAnalyser();
  analyser.fftSize=256;
  src.connect(analyser);
  analyser.connect(ctx.destination);
  dataArray=new Uint8Array(analyser.frequencyBinCount);
  audio.play();
}

function init(){
  scene=new THREE.Scene();
  camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
  camera.position.z=20;

  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth,innerHeight);
  document.body.appendChild(renderer.domElement);

  clock=new THREE.Clock();

  // LIGHT
  scene.add(new THREE.AmbientLight(0x555555));
  const light=new THREE.PointLight(0xff00ff,2,200);
  light.position.set(0,0,30);
  scene.add(light);

  // PARTICLES
  const geo=new THREE.BufferGeometry();
  const count=4000;
  const pos=new Float32Array(count*3);
  for(let i=0;i<count*3;i++){
    pos[i]=(Math.random()-0.5)*200;
  }
  geo.setAttribute("position",new THREE.BufferAttribute(pos,3));
  const mat=new THREE.PointsMaterial({color:0xffffff,size:0.6});
  particles=new THREE.Points(geo,mat);
  scene.add(particles);

  // TEXT
  const loader=new THREE.FontLoader();
  loader.load("https://threejs.org/examples/fonts/helvetiker_bold.typeface.json",(font)=>{
    const tg=new THREE.TextGeometry("CLOYZZI",{
      font,
      size:4,
      height:1,
      bevelEnabled:true,
      bevelThickness:0.3,
      bevelSize:0.2,
      bevelSegments:5
    });
    tg.center();
    const tm=new THREE.MeshStandardMaterial({
      color:0xffffff,
      metalness:1,
      roughness:0.2,
      emissive:0x220022
    });
    textMesh=new THREE.Mesh(tg,tm);
    scene.add(textMesh);
  });

  addEventListener("resize",()=>{
    camera.aspect=innerWidth/innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth,innerHeight);
  });
}

function animate(){
  requestAnimationFrame(animate);
  const t=clock.getElapsedTime();
  analyser.getByteFrequencyData(dataArray);
  const bass=dataArray[2]/255;

  // CAMERA
  camera.position.z=20+Math.sin(t*0.5)*2-bass*5;
  camera.rotation.z=Math.sin(t*0.2)*0.05;

  // PARTICLES
  particles.rotation.y+=0.0005+ bass*0.02;
  particles.rotation.x+=0.0003;

  // TEXT
  if(textMesh){
    textMesh.rotation.y+=0.01 + bass*0.1;
    textMesh.rotation.x=Math.sin(t)*0.2;
    textMesh.scale.setScalar(1 + bass*0.6);
    textMesh.material.emissiveIntensity=1 + bass*4;
  }

  renderer.render(scene,camera);
}
</script>
</body>
</html>

